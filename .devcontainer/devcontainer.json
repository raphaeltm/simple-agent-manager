{
	"name": "Simple Agent Manager",
	"image": "mcr.microsoft.com/devcontainers/typescript-node:24-bookworm",
	// Run as the non-root "node" user provided by the base image.
	// Without this, the devcontainer defaults to root.
	"remoteUser": "node",
	// Persist Codex state under the repo so MCP config survives container rebuilds.
	// Note: the stateful files in `.codex/` are gitignored.
	"containerEnv": {
		"CODEX_HOME": "/workspaces/simple-agent-manager/.codex"
	},
	"features": {
		// Docker-in-Docker for running workspace devcontainers
		"ghcr.io/devcontainers/features/docker-in-docker:2": {},
		// GitHub CLI for repo management
		"ghcr.io/devcontainers/features/github-cli:1": {},
		// Go for VM Agent development
		"ghcr.io/devcontainers/features/go:1": {
			"version": "1.22"
		}
	},
	// Ports for local development
	"forwardPorts": [
		8787, // API server
		5173, // Web dev server (Vite)
		3001 // CloudCLI (workspace access)
	],
	"portsAttributes": {
		"8787": {
			"label": "API",
			"onAutoForward": "notify"
		},
		"5173": {
			"label": "Web UI",
			"onAutoForward": "notify"
		},
		"3001": {
			"label": "CloudCLI",
			"onAutoForward": "notify"
		}
	},
	// Install dependencies after container creation
	"postCreateCommand": "bash .devcontainer/post-create.sh",
	// Create Claude config dir at container start (workspace-mounted path)
	"postStartCommand": "bash .devcontainer/post-start.sh",
	// VS Code extensions for better DX
	"customizations": {
		"vscode": {
			"extensions": [
				"dbaeumer.vscode-eslint",
				"esbenp.prettier-vscode",
				"bradlc.vscode-tailwindcss",
				"golang.go"
			],
			"settings": {
				"editor.formatOnSave": true,
				"editor.defaultFormatter": "esbenp.prettier-vscode"
			}
		}
	}
}
